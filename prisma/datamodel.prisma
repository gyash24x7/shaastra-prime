enum AccessLevel {
  COORD
  CORE
  COCAS
  COCAD
  HEAD
}

enum MessageStatus {
  SENT
  DELIVERED
  SEEN
}

enum ReactionType {
  LOVE
  HAHA
  CRY
  LIKE
}

enum MediaType {
  IMAGE
  AUDIO
  VIDEO
  CODE
  DOCUMENT
}

type User {
  id: ID! @id
  name: String!
  rollNumber: String! @unique
  email: String! @unique
  password: String!
  mobile: String! @unique
  upi: String!
  about: String! @default(value:"Hi, I am using Shaastra Prime")
  profilePic: String!
  coverPic: String!
  role: AccessLevel! @default(value: COORD)
  department: Department @relation(name:"DepartmentMember", link:INLINE)
  channels: [Channel!]! @relation(name:"ChannelMember")
  messages: [Message!]! @relation(name:"UserMessages", onDelete:CASCADE)
  seenMessages: [Message!]! @relation(name:"MessageSeenBy", link:TABLE)
  receivedMessages: [Message!]! @relation(name:"MessageReceivedBy", link:TABLE)
  seenMedia: [Media!]! @relation(name:"MediaSeenBy", link:TABLE)
  receivedMedia: [Media!]! @relation(name:"MediaReceivedBy", link:TABLE)
  media: [Media!]! @relation(name:"UserMedia")
  createdChannels: [Channel!]! @relation(name:"ChannelCreator")
  taggedMessages: [Message!]! @relation(name:"UserTags")
  reactions: [Reaction!]! @relation(name:"UserReactions")
}

type Department {
  id: ID! @id
  name: String!
  subDepartments: [String!]! @scalarList(strategy:RELATION)
  members: [User!]! @relation(name:"DepartmentMembers", onDelete:CASCADE)
}

type Channel {
  id: ID! @id
  name: String!
  createdAt: DateTime! @createdAt
  description: String!
  archived: Boolean! @default(value:false)
  members: [User!]! @relation(name:"ChannelMember", link:TABLE)
  messages: [Message!]! @relation(name:"ChannelMessages", onDelete:CASCADE)
  media: [Media!]! @relation(name:"ChannelMedia", onDelete:CASCADE)
  createdBy: User! @relation(name:"ChannelCreator", link:INLINE)
}

type Message {
  id: ID! @id
  content: String!
  createdAt: DateTime! @createdAt
  status: MessageStatus! @default(value:SENT)
  starred: Boolean! @default(value:false)
  createdBy: User! @relation(link:INLINE, name:"UserMessages")
  channel: Channel! @relation(link:INLINE, name:"ChannelMessages")
  seenBy: [User!]! @relation(name:"MessageSeenBy")
  receivedBy: [User!]! @relation(name:"MessagesReceivedBy")
  tagged: [User!]! @relation(name:"UserTags", link:TABLE)
  reactions: [Reaction!]! @relation(name:"MessageReactions")
}

type Media {
  id: ID! @id
  url: String!
  createdAt: DateTime! @createdAt
  status: MessageStatus! @default(value:SENT)
  starred: Boolean! @default(value:false)
  uploadedBy: User! @relation(link:INLINE, name:"UserMedia")
  channel: Channel! @relation(link:INLINE, name:"ChannelMedia")
  seenBy: [User!]! @relation(name:"MediaSeenBy")
  receivedBy: [User!]! @relation(name:"MediaReceivedBy")
}

type Reaction {
  id: ID! @id
  type: ReactionType!
  by: User! @relation(name:"UserReactions", link:INLINE)
  message: Message! @relation(name:"MessageReactions", link:INLINE)
}
